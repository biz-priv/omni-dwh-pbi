service: omni-dwh-pbi
frameworkVersion: '3'

provider:
  name: aws
  runtime: nodejs18.x
  versionFunctions: true
  stage: ${opt:stage, 'dev'}
  region: us-east-1
  timeout: 30
  memorySize: 256

package:
  individually: true

layers:
    OmniDWHLayer:
        path: lambdaLayer/lib
        name: ${self:service}-layer-${self:provider.stage}
        description: omni-dwh-pbi-services lambda layer for all node modules - ${self:provider.stage}
        compatibleRuntimes:
            - nodejs14.x
            - nodejs18.x
        retain: false

functions:
  omni_coe_table_reader: ${file(config/functions/omniCoeTable/omniCoeTableReaderFunction.yml):function}

resources:
  Resources:
    omniCoeTableReaderQueue: ${file(config/queues/omniCoeTableReader.yml):omniCoeTableReaderQueue}
    omniCoeTableReaderDLQ: ${file(config/queues/omniCoeTableReader.yml):omniCoeTableReaderDLQ}
    omniCoeTableReaderSubscription: ${file(config/queues/omniCoeTableReader.yml):omniCoeTableReaderSubscription}
    omniCoeTableReaderQueuePolicy: ${file(config/queues/omniCoeTableReader.yml):omniCoeTableReaderQueuePolicy}

plugins:
  - serverless-offline